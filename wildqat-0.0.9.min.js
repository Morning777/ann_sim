function ann(r)
	{
	for(var o=r.ite?r.ite:100,a=r.Ts?r.Ts:5,f=r.Tf?r.Tf:.02,t=r.Gs?r.Gs:10,n=r.Gf?r.Gf:.02,e=r.tro?r.tro:16,h=r.R?r.R:.95,i=r.mode?r.mode:"ising",s=r.read?r.read:1,u=r.J,d=a,M=u.length,c=new Array(M),m=[],l=[],p=[],v=new Object,g=0,y=0;
	y<M;
	y++)for(var w=y+1;
	w<M;
	w++)u[w][y]=u[y][w];
	if("qubo"==i)
		{
		for(y=0;
		y<M;
		y++)for(w=0;
		w<M;
		w++)y!=w&&(u[y][w]*=.25);
		for(y=0;
		y<M;
		y++)
			{
			var b=0;
			for(w=0;
			w<M;
			w++)b+=y==w?.5*u[y][y]:u[y][w];
			u[y][y]=b
		}
		for(y=0;
		y<M;
		y++)
			{
			g+=u[y][y];
			for(w=y+1;
			w<M;
			w++)g-=u[y][w]
		}
	}
	if(r.beta)for(y=0;
	y<M;
	y++)for(w=0;
	w<M;
	w++)u[y][w]*=r.beta;
	var A=s;
	if("sqa"==r.algo)for(;
	A>0;
	)
		{
		var J=t;
		for(y=0;
		y<e;
		y++)
			{
			c[y]=new Array(M);
			for(w=0;
			w<M;
			w++)c[y][w]=2*Math.floor(2*Math.random())-1
		}
		for(;
		J>n;
		)
			{
			for(y=0;
			y<o;
			y++)
				{
				var x=Math.floor(Math.random()*e),N=Math.floor(Math.random()*M),G=0;
				for(w=0;
				w<M;
				w++)G+=w==N?-2*c[x][N]*u[N][N]:-2*c[x][w]*c[x][N]*u[w][N];
				var T=J/f/e,E=Math.exp(T),O=Math.exp(-T);
				((G+=c[x][N]*(c[(e+x-1)%e][N]+c[(x+1)%e][N])*Math.log((E+O)/(E-O))/f)<0||Math.exp(-G/d)>Math.random())&&(c[x][N]=-c[x][N])
			}
			J*=h
		}
		0==m.length&&(m.push(c[0].concat()),l.push(Ei(c[0],u)+g),p.push(0));
		for(var S=0,q=0;
		q<m.length;
		q++)JSON.stringify(c[0])==JSON.stringify(m[q])&&(p[q]++,S++);
		0==S&&(m.push(c[0].concat()),l.push(Ei(c[0],u)+g),p.push(1)),A--
	}
	else for(;
	A>0;
	)
		{
		d=a;
		for(y=0;
		y<M;
		y++)c[y]=2*Math.floor(2*Math.random())-1;
		for(;
		d>f;
		)
			{
			for(y=0;
			y<o*e;
			y++)
				{
				for(N=Math.floor(Math.random()*M),G=0,w=0;
				w<M;
				w++)G+=w==N?-2*c[N]*u[N][N]:-2*c[w]*c[N]*u[w][N];
				(G<0||Math.exp(-G/d)>Math.random())&&(c[N]=-c[N])
			}
			d*=h
		}
		0==m.length&&(m.push(c.concat()),l.push(Ei(c,u)+g),p.push(0));
		for(S=0,q=0;
		q<m.length;
		q++)JSON.stringify(c)==JSON.stringify(m[q])&&(p[q]++,S++);
		0==S&&(m.push(c.concat()),l.push(Ei(c,u)+g),p.push(1)),A--
	}
	return v.e=l,v.answer=m,v.occerence=p,v.ite=o,"sqa"==r.algo?(v.Gs=t,v.Gf=n,v.tro=e):v.Ts=a,v.Tf=f,v.R=h,v.mode=i,v.read=s,v
}
function Ei(r,o)
	{
	for(var a=0,f=0;
	f<r.length;
	f++)
		{
		a+=r[f]*o[f][f];
		for(var t=f+1;
		t<r.length;
		t++)a+=r[f]*r[t]*o[f][t]
	}
	return a
}
function randJ(r)
	{
	for(var o=new Array(r),a=0;
	a<r;
	a++)
		{
		o[a]=new Array(r);
		for(var f=0;
		f<r;
		f++)o[a][f]=0;
		for(f=a;
		f<r;
		f++)o[a][f]=Number(Math.random().toFixed(2))
	}
	return o
}
function zeroJ(r)
	{
	for(var o=new Array(r),a=0;
	a<r;
	a++)
		{
		o[a]=new Array(r);
		for(var f=0;
		f<r;
		f++)o[a][f]=0
	}
	return o
}
function rbmJ(r)
	{
	for(var o=r[0]+r[1],a=new Array(o),f=0;
	f<o;
	f++)
		{
		a[f]=new Array(o);
		for(var t=0;
		t<o;
		t++)a[f][t]=0
	}
	for(f=0;
	f<o;
	f++)a[f][f]=Number(Math.random().toFixed(2));
	for(f=0;
	f<r[0];
	f++)for(t=r[0];
	t<r[0]+r[1];
	t++)a[f][t]=Number(Math.random().toFixed(2));
	return a
}
